<!doctype html>
<html>
  <head>
    <title>Radio SFD</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./styles/main.css">
  </head>
  <body>
    <audio id="music-player"></audio>
    <audio id="alert-player"></audio>

    <main>
      <div class="controls">
        <button class="controls__pause-music" type="button">
          <svg class="icon">
            <use xlink:href="#pause"></use>
          </svg>
        </button>
        <button class="controls__play-music" type="button">
          <svg class="icon">
            <use xlink:href="#play"></use>
          </svg>
        </button>
        <button class="controls__repeat-alert" type="button">
          <svg class="icon">
            <use xlink:href="#replay"></use>
          </svg>
        </button>
      </div>

      <div class="alert-player__text-wrapper">
        <blockquote class="alert-player__text"></blockquote>
      </div>
    </main>

    <figure class="turntable">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504">
      	<symbol id="glare" viewBox="0 0 504 504">
      		<path d="M252,252L23.337,351.929c24.089,55.042,67.457,99.716,121.577,125.474L252,252z"/>
      		<path d="M252,252l228.663-99.929c-24.089-55.042-67.457-99.715-121.577-125.473L252,252z"/>
      	</symbol>

  			<symbol id="track-transfers" viewBox="0 0 504 504">
  				<circle cx="252" cy="252" r="139.75"/>
  				<path d="M252,412c88.366,0,156.625-71.634,156.625-160
  					c0-86.502-70.123-153.25-156.625-153.25v0c-84.639,0-149.875,68.611-149.875,153.25c0,82.773,67.102,146.5,149.875,146.5
  					c80.91,0,143.125-65.59,143.125-146.5l0,0c0-79.047-64.078-139.75-143.125-139.75"/>
  				<path d="M252,464.201
  					c116.674,0,211.258-94.584,211.258-211.258c0-116.674-94.584-211.257-211.258-211.257"/>
  				<path d="M2.5,252
  					c0,137.796,111.704,247.767,249.5,247.767c136.838,0,246.033-110.929,246.033-247.767C498.033,116.119,387.881,7.7,252,7.7
  					C117.076,7.7,9.434,117.077,9.434,252c0,133.966,108.601,240.833,242.566,240.833"/>
  				<path d="M501.5,252
  					C501.5,114.205,389.795,4.233,252,4.233C115.162,4.233,5.967,115.162,5.967,252c0,135.881,110.152,244.3,246.033,244.3
  					c134.924,0,242.566-109.376,242.566-244.3c0-133.966-108.601-240.833-242.566-240.833"/>
  			</symbol>

  			<symbol id="track-2" viewBox="0 0 504 504">
  				<circle cx="252" cy="252" r="159.698"/>
  				<circle cx="252" cy="252" r="160.465"/>
  				<circle cx="252" cy="252" r="161.232"/>
  				<circle cx="252" cy="252" r="161.999"/>
  				<circle cx="252" cy="252" r="162.766"/>
  				<circle cx="252" cy="252" r="163.532"/>
  				<circle cx="252" cy="252" r="164.3"/>
  				<circle cx="252" cy="252" r="165.067"/>
  				<circle cx="252" cy="252" r="165.833"/>
  				<circle cx="252" cy="252" r="166.601"/>
  				<circle cx="252" cy="252" r="167.367"/>
  				<circle cx="252" cy="252" r="168.134"/>
  				<circle cx="252" cy="252" r="168.901"/>
  				<circle cx="252" cy="252" r="169.668"/>
  				<circle cx="252" cy="252" r="170.435"/>
  				<circle cx="252" cy="252" r="171.202"/>
  				<circle cx="252" cy="252" r="171.969"/>
  				<circle cx="252" cy="252" r="172.736"/>
  				<circle cx="252" cy="252" r="173.503"/>
  				<circle cx="252" cy="252" r="174.27"/>
  				<circle cx="252" cy="252" r="175.037"/>
  				<circle cx="252" cy="252" r="175.803"/>
  				<circle cx="252" cy="252" r="176.57"/>
  				<circle cx="252" cy="252" r="177.337"/>
  				<circle cx="252" cy="252" r="178.104"/>
  				<circle cx="252" cy="252" r="178.871"/>
  				<circle cx="252" cy="252" r="179.638"/>
  				<circle cx="252" cy="252" r="180.405"/>
  				<circle cx="252" cy="252" r="181.172"/>
  				<circle cx="252" cy="252" r="181.939"/>
  				<circle cx="252" cy="252" r="182.705"/>
  				<circle cx="252" cy="252" r="183.473"/>
  				<circle cx="252" cy="252" r="184.239"/>
  				<circle cx="252" cy="252" r="185.006"/>
  				<circle cx="252" cy="252" r="185.773"/>
  				<circle cx="252" cy="252" r="186.54"/>
  				<circle cx="252" cy="252" r="187.307"/>
  				<circle cx="252" cy="252" r="188.074"/>
  				<circle cx="252" cy="252" r="188.841"/>
  				<circle cx="252" cy="252" r="189.607"/>
  				<circle cx="252" cy="252" r="190.375"/>
  				<circle cx="252" cy="252" r="191.142"/>
  				<circle cx="252" cy="252" r="191.908"/>
  				<circle cx="252" cy="252" r="192.675"/>
  				<circle cx="252" cy="252" r="193.442"/>
  				<circle cx="252" cy="252" r="194.209"/>
  				<circle cx="252" cy="252" r="194.976"/>
  				<circle cx="252" cy="252" r="195.743"/>
  				<circle cx="252" cy="252" r="196.51"/>
  				<circle cx="252" cy="252" r="197.277"/>
  				<circle cx="252" cy="252" r="198.044"/>
  				<circle cx="252" cy="252" r="198.811"/>
  				<circle cx="252" cy="252" r="199.578"/>
  				<circle cx="252" cy="252" r="200.344"/>
  				<circle cx="252" cy="252" r="201.111"/>
  				<circle cx="252" cy="252" r="201.878"/>
  				<circle cx="252" cy="252" r="202.645"/>
  				<circle cx="252" cy="252" r="203.412"/>
  				<circle cx="252" cy="252" r="204.179"/>
  				<circle cx="252" cy="252" r="204.946"/>
  				<circle cx="252" cy="252" r="205.713"/>
  				<circle cx="252" cy="252" r="206.48"/>
  				<circle cx="252" cy="252" r="207.247"/>
  				<circle cx="252" cy="252" r="208.014"/>
  				<circle cx="252" cy="252" r="208.78"/>
  				<circle cx="252" cy="252" r="209.547"/>
  				<circle cx="252" cy="252" r="210.314"/>
  			</symbol>

  			<symbol id="track-1" viewBox="0 0 504 504">
  				<circle cx="252" cy="252" r="240.833"/>
  				<circle cx="252" cy="252" r="240.059"/>
  				<circle cx="252" cy="252" r="239.285"/>
  				<circle cx="252" cy="252" r="238.512"/>
  				<circle cx="252" cy="252" r="237.738"/>
  				<circle cx="252" cy="252" r="236.964"/>
  				<circle cx="252" cy="252" r="236.19"/>
  				<circle cx="252" cy="252" r="235.416"/>
  				<circle cx="252" cy="252" r="234.643"/>
  				<circle cx="252" cy="252" r="233.868"/>
  				<circle cx="252" cy="252" r="233.095"/>
  				<circle cx="252" cy="252" r="232.32"/>
  				<circle cx="252" cy="252" r="231.547"/>
  				<circle cx="252" cy="252" r="230.773"/>
  				<circle cx="252" cy="252" r="229.999"/>
  				<circle cx="252" cy="252" r="229.226"/>
  				<circle cx="252" cy="252" r="228.452"/>
  				<circle cx="252" cy="252" r="227.678"/>
  				<circle cx="252" cy="252" r="226.904"/>
  				<circle cx="252" cy="252" r="226.13"/>
  				<circle cx="252" cy="252" r="225.356"/>
  				<circle cx="252" cy="252" r="224.582"/>
  				<circle cx="252" cy="252" r="223.809"/>
  				<circle cx="252" cy="252" r="223.035"/>
  				<circle cx="252" cy="252" r="222.261"/>
  				<circle cx="252" cy="252" r="221.487"/>
  				<circle cx="252" cy="252" r="220.713"/>
  				<circle cx="252" cy="252" r="219.939"/>
  				<circle cx="252" cy="252" r="219.166"/>
  				<circle cx="252" cy="252" r="218.391"/>
  				<circle cx="252" cy="252" r="217.618"/>
  				<circle cx="252" cy="252" r="216.844"/>
  				<circle cx="252" cy="252" r="216.07"/>
  				<circle cx="252" cy="252" r="215.296"/>
  				<circle cx="252" cy="252" r="214.522"/>
  				<circle cx="252" cy="252" r="213.749"/>
  				<circle cx="252" cy="252" r="212.975"/>
  				<circle cx="252" cy="252" r="212.201"/>
      	</symbol>

      	<mask id="glare-mask">
      		<rect fill="#000" x="0" y="0" width="100%" height="100%" />
      		<use class="record__glare" fill="#fff" xlink:href="#glare"></use>
      		<use class="record__glare" fill="#fff" xlink:href="#glare"></use>
      	</mask>

      	<mask id="pin-hole">
      		<rect fill="#fff" x="0" y="0" width="100%" height="100%" />
      		<circle cx="252" cy="252" r="10.347"/>
      	</mask>

      	<path id="wax" mask="url(#pin-hole)" fill="#E81F2E" d="M252,0C112.824,0,0,112.824,0,252s112.824,252,252,252s252-112.824,252-252S391.176,0,252,0z
      		 M252.001,262.347c-5.715,0-10.348-4.632-10.348-10.347c0-5.714,4.633-10.347,10.348-10.347c5.714,0,10.346,4.633,10.346,10.347
      		C262.347,257.715,257.715,262.347,252.001,262.347z"/>

      		<g fill="none" stroke-width="0.25">
            <g stroke="#B2192C">
              <use class="record__transfers" xlink:href="#track-transfers"></use>
              <use xlink:href="#track-1"></use>
              <use xlink:href="#track-2"></use>
            </g>

            <g stroke="#fff" mask="url(#glare-mask)">
          		<rect fill="#ffffffdd" x="0" y="0" width="100%" height="100%" />
              <use class="record__transfers" xlink:href="#track-transfers"></use>
              <use xlink:href="#track-1"></use>
              <use xlink:href="#track-2"></use>
            </g>
          </g>


      	<image class="record__label" xlink:href="./images/label.svg" mask="url(#pin-hole)" width="247.458" height="247.458" x="128.271" y="128.271"/>
      	<circle id="label-emboss" fill="none" stroke="#E81F2E" stroke-width="0.25" cx="252" cy="252" r="35.875"/>
      </svg>

    </figure>

    <script>
      (() => {
        const date = new Date();
        const thisYear = date.getFullYear();
        const today = new Date(thisYear, 3, 2);
        const tonight = new Date(thisYear, 3, 3);

        if (date > tonight) {
          const nextYear = thisYear + 1;
          today.setYear(nextYear);
          tonight.setYear(nextYear);
        }

        window.today = today;
        window.tonight = tonight;

        const dataBaseUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSOm2jJdkR4kfIm2py2T1-KTu3d5h6naSu8T5L3NcOoxapLkU-BHGZ3uErCgRfl7TL90ttcwm_7VN8n/pub";
        window.scheduleUrl = `${dataBaseUrl}?output=csv&gid=0`;
        window.messagesUrl = `${dataBaseUrl}?output=csv&gid=2089493124`;
        window.tracks = [
          "audio/music/track-a.mp3#t=3.6,107",
          "audio/music/track-b.mp3",
        ];
      })();
    </script>
    <script>
      (() => {
        if (window.location.hash !== "#dev") return;

        const [year, month, date] = ((date) => {
          return [date.getFullYear(), date.getMonth(), date.getDate()];
        })(new Date());
        window.today = new Date(year, month, date);
        window.tonight = new Date(year, month, date + 1);

        const queue = new Date();
        const devMessages =
          'id,audio,text\n' +
          'msg-a,"audio/music/track-a.mp3#t=3.6,4.6","Va e detta häer nudå?"\n' +
          'msg-b,"audio/music/track-a.mp3#t=3.6,4.6","E la ente SFD nue?"\n';

        const devSchedule =
          'queue,message\n' +
          `${nextQueue()},msg-a\n` +
          `${nextQueue()},msg-b\n` +
          `${nextQueue()},msg-a\n` +
          `${nextQueue()},msg-b\n`;

        window.messagesUrl = 'data:,' + window.encodeURIComponent(devMessages);
        window.scheduleUrl = 'data:,' + window.encodeURIComponent(devSchedule);

        function nextQueue () {
          queue.setMinutes(queue.getMinutes() + 1);
          return queue.getHours() + ':' + queue.getMinutes();
        }
      })();
    </script>

    <script async type="module" src="/scripts/main.js"></script>

    <svg>
    	<symbol id="pause" viewBox="0 0 124.5 124.5">
    		<path d="M116.35,124.5c3.3,0,6-2.699,6-6V6c0-3.3-2.7-6-6-6h-36c-3.3,0-6,2.7-6,6v112.5c0,3.301,2.7,6,6,6H116.35z"/>
    		<path d="M44.15,124.5c3.3,0,6-2.699,6-6V6c0-3.3-2.7-6-6-6h-36c-3.3,0-6,2.7-6,6v112.5c0,3.301,2.7,6,6,6H44.15z"/>
    	</symbol>

    	<symbol id="play" viewBox="0 0 124.512 124.512">
    		<path d="M113.956,57.006l-97.4-56.2c-4-2.3-9,0.6-9,5.2v112.5c0,4.6,5,7.5,9,5.2l97.4-56.2
    			C117.956,65.105,117.956,59.306,113.956,57.006z"/>
    	</symbol>

    	<symbol id="quote" viewBox="0 0 975.036 975.036">
    		<path d="M925.036,57.197h-304c-27.6,0-50,22.4-50,50v304c0,27.601,22.4,50,50,50h145.5c-1.9,79.601-20.4,143.3-55.4,191.2
    			c-27.6,37.8-69.399,69.1-125.3,93.8c-25.7,11.3-36.8,41.7-24.8,67.101l36,76c11.6,24.399,40.3,35.1,65.1,24.399
    			c66.2-28.6,122.101-64.8,167.7-108.8c55.601-53.7,93.7-114.3,114.3-181.9c20.601-67.6,30.9-159.8,30.9-276.8v-239
    			C975.036,79.598,952.635,57.197,925.036,57.197z"/>
    		<path d="M106.036,913.497c65.4-28.5,121-64.699,166.9-108.6c56.1-53.7,94.4-114.1,115-181.2c20.6-67.1,30.899-159.6,30.899-277.5
    			v-239c0-27.6-22.399-50-50-50h-304c-27.6,0-50,22.4-50,50v304c0,27.601,22.4,50,50,50h145.5c-1.9,79.601-20.4,143.3-55.4,191.2
    			c-27.6,37.8-69.4,69.1-125.3,93.8c-25.7,11.3-36.8,41.7-24.8,67.101l35.9,75.8C52.336,913.497,81.236,924.298,106.036,913.497z"/>
    	</symbol>

    	<symbol id="replay" viewBox="0 0 305.836 305.836">
    	 <path d="M152.924,300.748c84.319,0,152.912-68.6,152.912-152.918c0-39.476-15.312-77.231-42.346-105.564
    		 c0,0,3.938-8.857,8.814-19.783c4.864-10.926-2.138-18.636-15.648-17.228l-79.125,8.289c-13.511,1.411-17.999,11.467-10.021,22.461
    		 l46.741,64.393c7.986,10.992,17.834,12.31,22.008,2.937l7.56-16.964c12.172,18.012,18.976,39.329,18.976,61.459
    		 c0,60.594-49.288,109.875-109.87,109.875c-60.591,0-109.882-49.287-109.882-109.875c0-19.086,4.96-37.878,14.357-54.337
    		 c5.891-10.325,2.3-23.467-8.025-29.357c-10.328-5.896-23.464-2.3-29.36,8.031C6.923,95.107,0,121.27,0,147.829
    		 C0,232.148,68.602,300.748,152.924,300.748z"/>
    	</symbol>
    </svg>
  </body>
</html>
